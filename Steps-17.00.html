
Create and Load 2nd Fact Table
17
<p><span style="background-color: rgb(255, 0, 0);">NOTE</span>: Download the attached file that has the SQL Update statements for Fact table 'Fact_HospitalCapacity'. Make sure fact table is created using code provided previously.</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/1.jpg" style="width: 50%;"></p><p><br></p><p>In the Control Flow pane, drag and drop a data flow task</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/2.jpg"></p><p>Double-click on DFT_Load_Fact_HospitalCapacity to move to the Data Flow panel</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/3.jpg" style="width: 50%;"></p><p><strong>Inside OLE DB Source<br>-</strong>Connect to ODS using SQL Command (provided in downloaded script) and get only the one with hospitalbed and employeeonpayroll column provided</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/4.jpg" style="width: 50%;"></p><p><br></p><p><strong style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;">Inside LookUp Tranformation<br>-</strong><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;">Checks what to load mayching on dim_date</span></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/5.jpg" style="width: 50%;"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"><br></span></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/6.jpg" style="width: 50%;"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"><br></span></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/7.jpg" style="width: 50%;"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"><br></span></p><p><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;">-Do the same as above for dim_Provider</span></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/8.gif" style="width: 50%;"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"><br></span></p><p><strong style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;">Inside Data Conversion<br></strong><font color="#283c46" face="-apple-system, system-ui, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol"><span style="font-size: 18px;">-Adjusts&nbsp;data type and data length</span></font></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/9.jpg" style="width: 50%;"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"><br></span><strong style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;">Inside Deriver Column<br>-</strong><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;">Calculate and generate EmployeetoBedratio Column</span></p><p><font color="#283c46" face="-apple-system, system-ui, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol"><span style="font-size: 18px;">Expression used:&nbsp;[N.TotalHospitalEmployeeOnPayroll] / [N.TotalHospitalBed]</span></font><br></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/10.jpg" style="width: 50%;"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"><br></span><strong style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;">Inside Fact_HospitalCapacity LookUp<br></strong><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;">-Checks if any match and redirects accordingly for an update or fresh insert</span></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/11.gif" style="width: 50%;"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"><br></span></p><p><strong style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;">Inside OLE DB Command<br></strong><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;">-Updates records if they already exist in the fact table</span></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/12.jpg" style="width: 50%;"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"><br></span></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/13.jpg" style="width: 50%;"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"><br></span></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/14.gif" style="width: 50%;"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"><br></span></p><p><font color="#283c46" face="-apple-system, system-ui, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol"><span style="font-size: 18px;"><b>Finally Inside OLE DB Destination</b></span></font></p><p><font color="#283c46" face="-apple-system, system-ui, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol"><span style="font-size: 18px;">-Loads all non matched data as fresh insert into Fact table</span></font></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/15.jpg" style="width: 50%;"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"><br></span></p><p><strong style="color: rgb(144, 19, 254);">Fact Tables Fact_HospitalCapacity loaded successfully<br></strong><bc-attachment sgid="BAh7CEkiCGdpZAY6BkVUSSIuZ2lkOi8vYmMzL0F0dGFjaG1lbnQvNTIyMTYwNjA3P2V4cGlyZXNfaW4GOwBUSSIMcHVycG9zZQY7AFRJIg9hdHRhY2hhYmxlBjsAVEkiD2V4cGlyZXNfYXQGOwBUMA==--29abe44b362c1f8a8d5bfeb0e3a1c114afd9cb39" content-type="image/png" url="https://preview.3.basecamp.com/3945211/blobs/63026cd0-5be9-11ee-98eb-22f4a2db5490/previews/full" href="https://storage.3.basecamp.com/3945211/blobs/63026cd0-5be9-11ee-98eb-22f4a2db5490/download/image.png" filename="image.png" filesize="92177" width="1326" height="649" previewable="true" presentation="gallery"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"></span></bc-attachment></p><div><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1422/9/16.jpg" style="width: 50%;"><strong style="color: rgb(144, 19, 254);"><br></strong></div><p><br><br></p><p><br><bc-attachment sgid="BAh7CEkiCGdpZAY6BkVUSSIuZ2lkOi8vYmMzL0F0dGFjaG1lbnQvNTIyMTYxNTA2P2V4cGlyZXNfaW4GOwBUSSIMcHVycG9zZQY7AFRJIg9hdHRhY2hhYmxlBjsAVEkiD2V4cGlyZXNfYXQGOwBUMA==--b3c52832c512b6316bd11284a9c52b1bb5f1d765" content-type="image/png" url="https://preview.3.basecamp.com/3945211/blobs/c3aafcdc-5be9-11ee-bbcc-f23298c1267f/previews/full" href="https://storage.3.basecamp.com/3945211/blobs/c3aafcdc-5be9-11ee-bbcc-f23298c1267f/download/image.png" filename="image.png" filesize="85050" width="1191" height="749" previewable="true" presentation="gallery"><span style="color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px;"></span></bc-attachment></p><figure class="attachment attachment--image attachment--png attachment--preview" data-attachment="" data-caption="image.png" data-preview-url="https://preview.3.basecamp.com/3945211/blobs/c3aafcdc-5be9-11ee-bbcc-f23298c1267f/previews/full" data-download-url="https://storage.3.basecamp.com/3945211/blobs/c3aafcdc-5be9-11ee-bbcc-f23298c1267f/download/image.png?attachment=true" data-size="85050" data-content-type="image/png" style="box-sizing: border-box; display: inline-block; margin: 1em 0px; width: 691px; max-width: 100%; text-align: center; line-height: 1; color: rgb(40, 60, 70); font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"></figure>

<div><span style="color: rgb(30, 144, 255); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 17.3333px;">Differences between fact tables and Dimension tables:&nbsp;</span><a href="https://www.simplilearn.com/fact-table-vs-dimension-table-article#:~:text=Fact%20tables%20can%20hold%20various,can%20act%20as%20independent%20variables." target="_blank">What is a Fact Table?</a><br></div>

